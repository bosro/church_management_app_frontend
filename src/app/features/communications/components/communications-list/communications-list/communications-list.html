<!-- src/app/features/communications/components/communications-list/communications-list.component.html -->
<div class="dashboard-layout">
  <app-sidebar></app-sidebar>

  <div class="dashboard-content">
    <app-header></app-header>

    <div class="dashboard-body">
      <div class="communications-container">
        <!-- Page Header -->
        <div class="page-header">
          <div class="header-left">
            <h1>Communications</h1>
            <p class="subtitle">Send messages to your members</p>
          </div>
          <button class="btn-primary" (click)="createCommunication()">
            <i class="ri-add-line"></i>
            <span>New Message</span>
          </button>
        </div>

        <!-- Success/Error Messages -->
        <div *ngIf="successMessage" class="success-alert">
          <i class="ri-checkbox-circle-line"></i>
          <span>{{ successMessage }}</span>
        </div>

        <div *ngIf="errorMessage" class="error-alert">
          <i class="ri-error-warning-line"></i>
          <span>{{ errorMessage }}</span>
        </div>

        <!-- Statistics Cards -->
        <div class="stats-grid" *ngIf="statistics">
          <div class="stat-card">
            <div class="stat-icon" style="background: #DDD6FE; color: #7C3AED;">
              <i class="ri-message-3-line"></i>
            </div>
            <div class="stat-info">
              <p class="stat-label">Total Messages</p>
              <h3 class="stat-value">{{ statistics.total_communications }}</h3>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-icon" style="background: #D1FAE5; color: #10B981;">
              <i class="ri-check-double-line"></i>
            </div>
            <div class="stat-info">
              <p class="stat-label">Messages Sent</p>
              <h3 class="stat-value">{{ statistics.sent_communications }}</h3>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-icon" style="background: #DBEAFE; color: #3B82F6;">
              <i class="ri-chat-3-line"></i>
            </div>
            <div class="stat-info">
              <p class="stat-label">Total SMS</p>
              <h3 class="stat-value">{{ statistics.total_sms }}</h3>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-icon" style="background: #FED7AA; color: #EA580C;">
              <i class="ri-mail-line"></i>
            </div>
            <div class="stat-info">
              <p class="stat-label">Total Emails</p>
              <h3 class="stat-value">{{ statistics.total_emails }}</h3>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions">
          <button class="action-btn" (click)="viewSmsLogs()">
            <i class="ri-message-3-line"></i>
            <span>SMS Logs</span>
          </button>
          <button class="action-btn" (click)="viewEmailLogs()">
            <i class="ri-mail-line"></i>
            <span>Email Logs</span>
          </button>
        </div>

        <!-- Loading State -->
        <div *ngIf="loading" class="loading-container">
          <app-loading-spinner message="Loading communications..."></app-loading-spinner>
        </div>

        <!-- Communications List -->
        <div *ngIf="!loading" class="communications-list">
          <div *ngFor="let comm of communications" class="communication-card">
            <div class="card-header">
              <div class="comm-icon" [class]="getTypeIcon(comm.communication_type)">
                <i [class]="getTypeIcon(comm.communication_type)"></i>
              </div>
              <div class="comm-info">
                <h3>{{ comm.title }}</h3>
                <p class="comm-meta">
                  {{ comm.communication_type === 'sms' ? 'SMS' : comm.communication_type === 'email' ? 'Email' : 'SMS & Email' }}
                  • {{ comm.target_audience | titlecase }}
                  • {{ comm.created_at | date:'MMM d, y h:mm a' }}
                </p>
              </div>
              <div class="comm-status">
                <span class="status-badge" [ngClass]="getStatusClass(comm.status)">
                  {{ getStatusLabel(comm.status) }}
                </span>
              </div>
            </div>

            <div class="card-body">
              <p class="comm-message">{{ comm.message }}</p>
            </div>

            <div class="card-actions">
              <button
                *ngIf="comm.status === 'draft'"
                class="btn-action btn-send"
                (click)="sendCommunication(comm.id, $event)"
              >
                <i class="ri-send-plane-line"></i>
                Send Now
              </button>
              <button
                class="btn-action btn-delete"
                (click)="deleteCommunication(comm.id, $event)"
              >
                <i class="ri-delete-bin-line"></i>
                Delete
              </button>
            </div>
          </div>

          <!-- Empty State -->
          <div *ngIf="communications.length === 0" class="empty-state">
            <i class="ri-message-3-line"></i>
            <h3>No Messages Yet</h3>
            <p>Create your first message to communicate with members</p>
            <button class="btn-primary" (click)="createCommunication()">
              <i class="ri-add-line"></i>
              New Message
            </button>
          </div>
        </div>

        <!-- Pagination -->
        <div class="pagination" *ngIf="totalPages > 1 && !loading">
          <button
            class="pagination-btn"
            [disabled]="currentPage === 1"
            (click)="previousPage()"
          >
            <i class="ri-arrow-left-s-line"></i>
            Previous
          </button>

          <div class="pagination-pages">
            <span class="page-info">
              Page {{ currentPage }} of {{ totalPages }} ({{ totalCommunications }} messages)
            </span>
          </div>

          <button
            class="pagination-btn"
            [disabled]="currentPage === totalPages"
            (click)="nextPage()"
          >
            Next
            <i class="ri-arrow-right-s-line"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
